# CCNP IGRP
Interior Gateway Routing Protocol

# Convergence, 收斂的方法

* Split Horizon Update, 水平分割更新法

 水平分割使指閘道器會紀錄所接收到的路徑資訊是由哪一個網路介面而來的，同時不可將此路徑傳回給同樣的網路介面，避免造成迴圈。
 
 當 GW 1 （ RouterC E0 ）和 Net 1 中斷時，GW 2 (Router A s0) 經由 GW 1 到達 Net 1 時，距離為 2，一旦中斷，GW 2 不會再對 GW 1 廣播這條路徑，GW 1 也停止廣播此網路至 Net 1 的路徑，經過幾回合路徑更新後，各個閘道會發現此網路 Net 1 是 unreachabel，便不會造成迴圈了。
 
 路由器 A 和 路由器 B 的 192.168.4.0 這網段是由路由器 C 所學習來的，所以不會反向更新路徑。
 
                                               
                                                
                                  Router A           
                                  
                                     GW2
                                 s0      s1
                                 /         \
                 192.168.1.0    /           \  192.168.3.0
                               /             \
                              /               \
                            s1   s0 ----- s1   s0    
                                                
                                 192.168.2.0
                                                       GW1
                       Router B             Router C    E0 ---X--- E0  Router D
                       
                                                         192.168.4.0
                       
                       
    +--------------------------+                  
    |      Routing Table A     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.1.0| s0  |    0   |
    +-----------+-----+--------+
    |192.168.3.0| s1  |    0   |
    +-----------+-----+--------+
    |192.168.2.0| s0  |    1   |
    +-----------+-----+--------+
    |192.168.4.0| s0  |    2   |
    +-----------+-----+--------+
    
    
    +--------------------------+                  
    |      Routing Table B     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.1.0| s1  |    0   |
    +-----------+-----+--------+
    |192.168.2.0| s0  |    0   |
    +-----------+-----+--------+
    |192.168.3.0| s0  |    1   |
    +-----------+-----+--------+
    |192.168.4.0| E0  |    1   |
    +-----------+-----+--------+
    
    
    +--------------------------+                  
    |      Routing Table C     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.2.0| s1  |    0   |
    +-----------+-----+--------+
    |192.168.3.0| s0  |    0   |
    +-----------+-----+--------+
    |192.168.1.0| s1  |    1   |
    +-----------+-----+--------+
    |192.168.4.0| E0  |  down  |
    +-----------+-----+--------+
    
    
    +--------------------------+                  
    |      Routing Table D     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.4.0| E0  | 0/down |
    +-----------+-----+--------+
    
 
 
    
* Poison Reverse + * Triggered Updates, 毒性逆向 ＋ 觸發更新

此法規定原本最先廣播該路徑的 GW 遇到路徑中斷時，必須將路徑修改至無限長 (= 16)，此資訊亦將保留若干週期。
    
   
   
 
 

   
* Hold Down Timer, 倒數計時更新法

此更新方式是用來解決故障資訊比正當資訊傳送的慢的問題，原理是讓故障資訊保持充足時間傳送，當閘道器收到此網路 unreachable 時，一定時間內，例如 60 秒內，閘道器不會再接收關於這網路的路徑資訊。

缺點是，此法會造成迴圈，使得網路效率大減。

可見實際路由表變化，來觀察 Hold Down Timer 的運作機制，當路由器 C 介面 E0 線路中斷後，介面 E0 的 metric 值改成 down，並且通知路由器 B，再通知路由器 A，AB 都在 Holddown 時間過後，方才更新路由表。


                                                
                                  Router A           
                                  
                                     GW2
                                 s0      s1
                                 /         \
                 192.168.1.0    /           \  192.168.3.0
                               /             \
                              /               \
                            s1   s0 ----- s1   s0    
                                                
                                 192.168.2.0
                                                       GW1
                       Router B             Router C    E0 ---X--- E0  Router D
                       
                                                         192.168.4.0
                       
                        
    +--------------------------+                  
    |      Routing Table A     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.1.0| s0  |    0   |
    +-----------+-----+--------+
    |192.168.3.0| s1  |    0   |
    +-----------+-----+--------+
    |192.168.2.0| s0  |    1   |
    +-----------+-----+--------+
    |192.168.4.0| s0  |    2   |
    +-----------+-----+--------+
    
    
    +--------------------------+                  
    |      Routing Table B     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.1.0| s1  |    0   |
    +-----------+-----+--------+
    |192.168.2.0| s0  |    0   |
    +-----------+-----+--------+
    |192.168.3.0| s0  |    1   |
    +-----------+-----+--------+
    |192.168.4.0| E0  |    1   |
    +-----------+-----+--------+
    
    
    +--------------------------+                  
    |      Routing Table C     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.2.0| s1  |    0   |
    +-----------+-----+--------+
    |192.168.3.0| s0  |    0   |
    +-----------+-----+--------+
    |192.168.1.0| s1  |    1   |
    +-----------+-----+--------+
    |192.168.4.0| E0  |  down  |
    +-----------+-----+--------+
    
    
    +--------------------------+                  
    |      Routing Table D     |
    +--------------------------+
    |    IP     | Int | Metric |   
    +-----------+-----+--------+
    |192.168.4.0| E0  | 0/down |
    +-----------+-----+--------+
    






